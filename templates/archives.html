{% extends "base.html" %}

{% block content %}
<div class="archives">
    <h1>Archives</h1>

    {% set posts_section = get_section(path="posts/_index.md") %}

    {% if posts_section.pages %}
        {% set years = [] %}
        {% for page in posts_section.pages %}
            {% if page.date %}
                {% set year = page.date | date(format="%Y") %}
                {% if year not in years %}
                    {% set_global years = years | concat(with=year) %}
                {% endif %}
            {% endif %}
        {% endfor %}

        {% for year in years | sort | reverse %}
            <div class="year-group">
                <h2>{{ year }}</h2>
                <ul class="post-list">
                    {% for page in posts_section.pages %}
                        {% if page.date %}
                            {% set page_year = page.date | date(format="%Y") %}
                            {% if page_year == year %}
                                <li class="post-item">
                                    <a href="{{ page.permalink }}">{{ page.title }} ({{ page.date | date(format="%m-%d-%y") }})</a>
                                </li>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        {% endfor %}
    {% else %}
        <p>No posts yet.</p>
    {% endif %}
</div>
{% endblock content %}
